"use strict";(self.modernJsonp=self.modernJsonp||[]).push([[62454,86384],{482535:(e,t,n)=>{n.d(t,{F9:()=>d,LM:()=>s,VZ:()=>o,cQ:()=>u,rZ:()=>a});var r=n(719413),i=n(535768);let o=()=>"number"==typeof window.innerHeight&&"number"==typeof window.pageYOffset&&!!document.querySelector&&!!document.querySelectorAll,a=e=>e instanceof HTMLDivElement||e instanceof HTMLVideoElement?e.getBoundingClientRect():e.parentElement instanceof HTMLElement?e.parentElement.getBoundingClientRect():null,l=e=>{if(e instanceof HTMLImageElement)return e.src;if(e instanceof HTMLVideoElement)return e.attributes.poster.value;let t=((e.style||{}).backgroundImage||"").match(/^url\(["'](.*)["']\)$/);return t&&t[1]||null},s=()=>document.querySelector?document.querySelectorAll(r.wc).length:((0,i.H)("missing_document_query_selector"),0),d=()=>{let e=(()=>{if(!document.querySelector)return(0,i.H)("missing_document_query_selector"),null;let e=document.querySelectorAll(r.wc);return e[e.length-1]||null})();if(!e)return!1;let t=window.innerHeight||0,n=window.pageYOffset||0;return e.getBoundingClientRect().top+n>=t},u=(e,t,n)=>{if(!document.querySelector)return(0,i.H)("missing_document_query_selector"),[];let o={foldY:window.innerHeight||0,pageYOffset:window.pageYOffset||0},s=[r.Wf,...e?[r.fF]:[],...t?[r.$N]:[]].join(","),d=[...document.querySelectorAll(s)];if(n){let e=[...document.querySelectorAll('div[data-test-id="board-section"]')],t=e=>{let n=[...e.children];!n.length&&e.style.backgroundImage?d.push(e):n.length&&n.forEach(e=>{t(e)})};e.forEach(e=>{t(e)})}return d.reduce((e,n)=>{if((n instanceof HTMLImageElement||n instanceof HTMLDivElement||n instanceof HTMLVideoElement&&t)&&((e,t)=>{let n=a(e);if(!n)return(0,i.H)("missing_client_rect"),!1;if(n.width<70&&n.height<70){if(e instanceof HTMLImageElement)return!1;let t=l(e);if(t?.endsWith("svg"))return!1}return(({top:e,height:t},{foldY:n,pageYOffset:r})=>{let i=e+r;if(i>=n)return!1;let o=Math.min(t,n-i);return o>.5*t||o>.2*n})(n,t)})(n,o)){let t=l(n);if(t){let r=(t||"").replace(/.*\//,"");return e.concat([{element:n,fileName:r}])}}return e},[])}},719413:(e,t,n)=>{n.d(t,{$N:()=>s,Kb:()=>r,Wf:()=>a,fF:()=>l,wc:()=>o});let r="pwt-grid-item",i=['div[data-grid-item="true"]',"div.Grid__Item",`div[data-test-id="${r}"]`],o=i.join(","),a=i.map(e=>`${e} img`).join(","),l=i.map(e=>`${e} div[style*=background-image]`).join(","),s=i.map(e=>`${e} video`).join(",")},300509:(e,t,n)=>{n.d(t,{Z:()=>g,v:()=>p});var r=n(667294),i=n(150739),o=n(482535),a=n(535768),l=n(17433),s=n(331118),d=n(116657),u=n(349057),c=n(481714),m=n(992114);let f=(0,i.XV)("GridProfiler"),p=()=>!!window.addEventListener&&!!window.removeEventListener&&(0,o.VZ)();function g({isAtEndOfFeed:e,pinData:t,includeBackgroundImages:n,includeVideos:p=!1,includeSections:g,isPlaceholderGrid:h,stopwatchSetVisuallyCompleteResult:E,stopwatchContext:y}){let _=(0,d.P9)(),[v,T]=(0,r.useState)({status:"DISABLED"});(0,r.useEffect)(()=>{T({status:"LAYOUT",failedCount:0,numOfItemsChecked:0})},[_]),(0,r.useEffect)(()=>{if(f("new status",v),"LAYOUT"===v.status){let e=((e,t)=>{let n=()=>{window.removeEventListener(e,n),t()};return window.addEventListener(e,n),()=>window.removeEventListener(e,n)})("scroll",()=>{(0,l.ZP)("scrollDuringLayout")});return()=>{e()}}return()=>{}},[v.status]),(0,c.Z)(()=>{let r=(0,d.Ly)(),l=()=>{},c=e=>{(0,d.JG)(e),y&&y?.abort()};"unknown"!==r?l=u.rt:(r=`${y?.name}`,y?.addBinaryAnnotation&&(l=y?.addBinaryAnnotation));let _=(0,o.cQ)(n,p,g);if(h)return void f("bypassing PWT run due to skeleton pin grid");switch(v.status){case"LAYOUT":{let t=((e,t)=>{if(!t){let t=(0,o.LM)();if(t===e)return f("No new items, so skip the viewport-fill check."),{complete:!1,numOfItemsChecked:e};if(!(0,o.F9)())return f("Viewport may not be filled yet."),{complete:!1,numOfItemsChecked:t}}return{complete:!0}})(v.numOfItemsChecked,e);t.complete?T({status:"TIMING",failedCount:0,pinElements:_}):500*v.failedCount>6e4?((0,a.A9)(`images.${r}.visuallyComplete.maxLayoutAttempt`),c("visuallyComplete_layoutTimeout"),T({status:"DISABLED"})):T({...v,failedCount:v.failedCount+1,numOfItemsChecked:t.numOfItemsChecked});break}case"TIMING":{let e=(0,s.Cg)(),n=v.pinElements.length,o=[],u=0,p=0,g=0,h=1/0,y=0;if(v.pinElements.forEach(({element:t,fileName:n})=>{let a=e.find(e=>e.name.endsWith(n));a?a.responseEnd?(o.push(a),(0,i.v5)(t,"green"),"SEARCH_FEED_RENDER"===r&&(h=Math.min(h,a.requestStart),y=Math.max(y,a.responseEnd))):(g+=1,(0,i.v5)(t,"blue")):t instanceof HTMLImageElement&&t.complete?(p+=1,(0,i.v5)(t,"red")):(u+=1,(0,i.v5)(t,"greenyellow"))}),u||g)100*v.failedCount>6e4?((0,a.A9)(`images.${r}.visuallyComplete.maxAttempt`,{tags:{totalImageCount:n,incompleteCount:u,noTimingCount:p,noTimingResponseEndCount:g}}),c("visuallyComplete_timingTimeout"),T({status:"DISABLED"})):T({...v,failedCount:v.failedCount+1});else{if(f(`All ${o.length} images are fetched`),t&&t.length){var w,S;let e,n,i,o,s,u=(w=t,S=v.pinElements,e=0,n=0,i=0,o=0,s=0,w=w.filter(e=>"pin"===e.type),S.forEach((t,r)=>{let a,l=t.fileName.split(".")[0];a=w[r],l!==a?.image_signature&&(a=w.find(e=>l===e?.image_signature)),void 0===a?s+=1:a.is_promoted||a.recommendation_reason?.reason==="PROMOTED_PIN"||a?.promoter?.length?i+=1:null!==a.story_pin_data_id&&void 0!==a.story_pin_data_id?e+=1:a?.videos?.video_list?n+=1:o+=1}),{storyPinCount:e,videoCount:n,adCount:i,imageCount:o,unknownCount:s});if(Object.entries(u).forEach(([e,t])=>{l(e,t,"I16"),(0,d.XJ)(e,t,"I16")}),(0,a.A9)(`${r}.pinTypes`,{tags:u}),"SEARCH_FEED_RENDER"===r){let e=y-h;t[0].display_options?.num_columns_requested===0?(0,m.LY)("full_width_story_image_fetch_time_true",e,{sampleRate:1}):(0,m.LY)("full_width_story_image_fetch_time_false",e,{sampleRate:.05})}}(({imageTimings:e})=>{E&&E(),(0,d.cB)(e)})({imageTimings:o}),T({status:"DISABLED"}),(0,a.A9)(`images.${r}.visuallyComplete.complete`,{tags:{totalImageCount:n,noTimingCount:p}})}}}},"LAYOUT"===v.status&&500||"TIMING"===v.status&&100||null)}},850625:(e,t,n)=>{n.d(t,{N:()=>_,W:()=>y});var r=n(17433),i=n(88835),o=n(933839),a=n(856516),l=n(632712),s=n(777344);let d=(e,t)=>Object.keys(t).reduce((n,r)=>({...n,[`${e}${r}`]:t[r]}),{});var u=n(479288),c=n(992114);let m=["client-","vendor-react-","index-","runtime-","locale-"],f=["PinResource","UserHomefeedResource","BaseSearchResource","BoardResource","UserResource","BoardFeedResource","runtime-","polyfills-","locale-","vendor-react-","vendor-react-","client-","index-","AuthDesktopHeader","DefaultPinRep","StructuredFeed","[id]-","[scope]-","[username]-","CloseupActionBarCommon-","SaveAffordance-"],p=({eventPrefix:e,endTime:t,tags:n,resourceArr:r,resourceType:i="allResources"})=>{let o=r.length;if("object"==typeof r[0]&&!Array.isArray(r[0])&&0!==o){if(m.includes(i)){let t=r[0],o={...n,swIntercepted:t.workerStart>0,workerFinalSourceType:t.workerFinalSourceType||"unknown"};(0,c.LY)(`${e}.app_start_script_${i.replace("-","")}.InFlight`,t.fetchStart,{tags:o}),(0,c.LY)(`${e}.app_start_script_${i.replace("-","")}.Complete`,t.responseEnd,{tags:o})}if(f.includes(i)){let t=r[0];(0,c.LY)(`${e}.critical_resource_${i.replace("-","")}.InFlight`,t.fetchStart,{tags:n}),(0,c.LY)(`${e}.critical_resource_${i.replace("-","")}.Complete`,t.responseEnd,{tags:n})}else{let a=[...r].sort((e,t)=>e.fetchStart-t.fetchStart),l=[...r].sort((e,t)=>e.responseEnd-t.responseEnd),s=1,d=t/5,u=0;for(;s<=5;){let t=0;for(;u<=o-1&&a[u].fetchStart<=d*s;)u+=1,t+=1;(0,c.S0)(`${e}.${i}.fetchStartInterval${s}of5`,t,{sampleRate:.2}),s+=1}let m={InFlightP0:a[0].fetchStart,InFlightP25:a[Math.floor(o/4)].fetchStart,InFlightP50:a[2*Math.floor(o/4)].fetchStart,InFlightP75:a[3*Math.floor(o/4)].fetchStart,InFlightP100:a[o-1].fetchStart,CompleteP25:l[Math.floor(o/4)].responseEnd,CompleteP50:l[2*Math.floor(o/4)].responseEnd,CompleteP75:l[3*Math.floor(o/4)].responseEnd,CompleteP100:l[o-1].responseEnd};for(let t in m)m[t]&&(0,c.LY)(`${e}.${i}.${t}`,m[t],{tags:n})}}};var g=n(286272),h=n(331118);let E=({type:e,annotateExperiments:t,annotations:n,binaryAnnotations:c,constraintMap:E,endTime:y,imageTimings:_,isV4Logger:v,metricId:T,pwtStaticContext:w,startTime:S,traceId:I,spans:C})=>{let L,A=(0,h.Cg)();"initial_app_load"===T.navigationType&&(L=(0,o.Z)());let $=_.map(({name:e})=>e),M=A.map(e=>(0,a.p)(e,$)).filter(({timing:e})=>!(({startTime:e,responseEnd:t},n)=>e>n.endTime||!!t&&t<n.startTime)(e,{startTime:S,endTime:y})),R=((0,r.E3)()||[]).map(e=>({name:e.name,id:(0,g.Z)(),parentId:I,startTime:e.startTime||S,endTime:e.endTime,annotationMap:{},binaryAnnotationMap:{}})).filter(e=>!(({startTime:e,endTime:t},n)=>e>n.endTime||!!t&&t<n.startTime)(e,{startTime:S,endTime:y}));return .2>Math.random()&&(({annotateExperiments:e,endTime:t,entries:n,metricId:r,pwtStaticContext:i})=>{let{isAuthenticated:o,isBot:a,isSocialBot:l,deviceType:s}=i,d=`${l&&"socialBot"||a&&"bot"||"nonbot"}.${s}.${r.surface}`,u=[d];e&&[...new Set(e)].forEach(e=>{let t=i.getExperimentGroup(e);t&&u.push(`${d}.experiment.${e}.${t}`)});let c={isAuthenticated:o,navigationType:r.navigationType,startType:i.startType},g=Array.from(n.filter(e=>"number"==typeof e.encodedBodySize&&("xmlhttprequest"===e.initiatorType&&e.encodedBodySize>=1e3||e.encodedBodySize>=1e4)&&e.responseEnd<=t)),h={img:[],css:[],script:[],xmlhttprequest:[],preloadedImages:[]};g.forEach(e=>{if("link"===e.initiatorType&&e.name.includes("i.pinimg.com"))h.preloadedImages=[...h.preloadedImages||[],e];else if(e.initiatorType in h){let t=e.initiatorType;h[t]=[...h[t]||[],e];let n=f.find(t=>e.name.includes(t));n&&(h[n]=[e]);let r=m.find(t=>e.name.includes(t));r&&(h[r]=[e])}}),u.forEach(e=>{p({eventPrefix:e,endTime:t,tags:c,resourceArr:g}),Object.entries(h).forEach(([n,r])=>{p({eventPrefix:e,endTime:t,tags:c,resourceArr:r,resourceType:n})})})})({annotateExperiments:t,endTime:y,entries:A,metricId:T,pwtStaticContext:w}),{traceId:I,startTime:S,endTime:y,spans:[...M.map(e=>(0,u.Z)(e,I)).filter(Boolean),...R].concat(C),annotationMap:(({constraintMap:e,initialNavTiming:t,annotations:n})=>({...n,...d("constraint_",e),...d("mark_",(0,r.gQ)()),...d("browser_",{...t?{...(0,l.Z)(t),domComplete:t.domComplete||0,domContentLoadedEventStart:t.domContentLoadedEventStart||0,domInteractive:t.domInteractive||0,workerStart:t.workerStart||0}:{},...(()=>{let{largestContentfulPaint:e}=(0,s.v2)();return{largestContentfulPaint:e||0}})()})}))({constraintMap:E,initialNavTiming:L,annotations:n}),binaryAnnotationMap:(0,i.rA)({initialNavTiming:L||{},type:e,annotateExperiments:t,binaryAnnotations:c,entries:A,isV4Logger:v,metricId:T,performanceResources:M,pwtEndTime:y,pwtStaticContext:w})}},y=({annotateExperiments:e,annotations:t,binaryAnnotations:n,constraintMap:r,endTime:i,imageTimings:o,isV4Logger:a=!1,metricId:l,pwtStaticContext:s,startTime:d,traceId:u,spans:c})=>({type:"COMPLETE",...E({type:"COMPLETE",annotateExperiments:e,annotations:t,binaryAnnotations:n,constraintMap:r,endTime:i,imageTimings:o,isV4Logger:a,metricId:l,pwtStaticContext:s,startTime:d,traceId:u,spans:c})}),_=({reason:e,annotateExperiments:t,annotations:n,binaryAnnotations:r,constraintMap:i,endTime:o,imageTimings:a,isV4Logger:l=!1,metricId:s,pwtStaticContext:d,startTime:u,traceId:c,spans:m})=>({type:"ABORT",reason:e,...E({type:"ABORT",annotateExperiments:t,annotations:n,binaryAnnotations:r,constraintMap:i,endTime:o,imageTimings:a,isV4Logger:l,metricId:s,pwtStaticContext:d,startTime:u,traceId:c,spans:m})})},481714:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(667294);let i=(e,t)=>{let n=(0,r.useRef)(()=>{});(0,r.useEffect)(()=>{n.current=e},[e]),(0,r.useEffect)(()=>{if(null===t)return()=>{};let e=setInterval(()=>n.current(),t);return()=>clearInterval(e)},[t])}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/62454-4d020e9a286ff6f7.mjs.map