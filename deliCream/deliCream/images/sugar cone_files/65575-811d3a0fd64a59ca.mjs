"use strict";(self.modernJsonp=self.modernJsonp||[]).push([[65575,76183],{30694:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(691772),a=i(992114);function s(e,t,i,s,r){let o=new URLSearchParams,p=t.reduce((e,t)=>{if(null!=t){let i=function(e){let t;try{t=decodeURIComponent(e)}catch(i){t=e}t.startsWith("http")?t.startsWith("http://")&&(t=t.replace("http://","https://")):t="https://"+t;try{return new URL(t).origin}catch(n){let i=t.match(/^(https?:\/\/[^\/]+)(\/|$)/);if(i&&i.length>1)return i[1];return e}}(t);return e.add(i)}return e},new Set);o.append(n.NR.SOURCE_EVENT_ID,e??"0"),o.append(n.NR.DESTINATION,JSON.stringify([...p])),o.append(n.NR.EXPIRY,i?n.uV:n.ug),o.append(n.NR.PRIORITY,i?n.NR.CLICK_PRIORITY:n.NR.VIEW_PRIORITY),r&&o.append(n.NR.ADVERTISER_ID,r),s&&o.append(n.NR.CAMPAIGN_ID,s),o.append(n.NR.SOURCE_EVENT_TYPE,i?n.bC:n.Cu);try{let{hostname:e}=new URL(window.location.href);"www.pinterest.com"!==e&&o.append(n.NR.HOSTNAME,e)}catch(e){(0,a.nP)("webapp.arapi.generateARASourceEventURL",{sampleRate:.1,tags:{status:"failed",href:window&&window.location&&window.location.href}})}return"https://www.pinterest.com/attribution_source/?"+o.toString()}},576183:(e,t,i)=>{i.d(t,{G6:()=>s,i7:()=>r,oi:()=>n,u$:()=>a,un:()=>p,vU:()=>o,w1:()=>d});let n=Object.freeze({OTHER:0,CHROME:1,SAFARI:2,IE:3,FIREFOX:4,OPERA:5,EDGE:6}),a=e=>e?e.includes("Chrome")?n.CHROME:e.includes("Safari")?n.SAFARI:e.includes("Firefox")?n.FIREFOX:e.includes("Opera")?n.OPERA:e.includes("IE")?n.IE:e.includes("Edge")?n.EDGE:n.OTHER:n.OTHER;function s(e){return a(e)===n.SAFARI}function r(e){return a(e)===n.CHROME}function o(e){return a(e)===n.FIREFOX}function p(e){return a(e)===n.EDGE}function d(e){return a(e)===n.IE}},586033:(e,t,i)=>{i.d(t,{Fw:()=>f,ZP:()=>P});var n=i(667294),a=i(30694),s=i(18644),r=i(992114);async function o(e,t,i,n,o,p,d,l,m){let c,{appType:u,osType:T}=p||{},v="",g="";if(["Pin","pinImpressions"].includes(e)&&t&&(n||l||m)){(0,r.nP)("webapp.arapi.view.funnel",{sampleRate:.1,tags:{status:"start",appType:u,osType:T}});try{if(!window.document.featurePolicy?.allowsFeature("attribution-reporting"))return void(0,r.nP)("webapp.arapi.view.funnel",{sampleRate:.1,tags:{status:"skipped",message:"attribution-reporting is not enabled",appType:u,osType:T}});v=(0,a.Z)(i,[n,l,m],!1,o,d);try{g=new URL(window.location.href).hostname}catch(e){(0,r.nP)("webapp.arapi.view.funnel",{sampleRate:.1,tags:{status:"hostname_parse_failed",href:window&&window.location&&window.location.href}})}if(g&&"www.pinterest.com"!==g)document.createElement("img").setAttribute("attributionsrc",v),(0,r.nP)("webapp.arapi.view.funnel",{sampleRate:.1,tags:{status:"international",appType:u,osType:T,hostname:g}});else if(!(c=await window.fetch(v,{keepalive:!0,attributionReporting:{eventSourceEligible:!0,triggerEligible:!1}})).ok)throw Error("server request failed.");(0,r.nP)("webapp.arapi.view.funnel",{sampleRate:.1,tags:{status:"success",appType:u,osType:T}})}catch(e){(0,r.nP)("webapp.arapi.view.funnel",{sampleRate:.1,tags:{status:"failed",error:(0,s.Z)(e,"name"),message:(0,s.Z)(e,"message"),appType:u,osType:T,hostname:g,responseStatus:c&&c.status}})}}else(0,r.nP)("webapp.arapi.view.funnel",{sampleRate:.1,tags:{status:"missing_param",appType:u,osType:T}})}var p=i(576183),d=i(19963),l=i(824834),m=i(94970),c=i(967312),u=i(174646),T=i(538645),v=i(422908),g=i(813509),w=i(438596);let y={ActivationCard:{impressionType:"activationCardImpressions",idType:"experienceIdStr",eventType:8547},Article:{impressionType:"articleImpressions",idType:"articleIdStr",eventType:3829},Banner:{impressionType:"bannerImpressions",idType:"userIdStr",eventType:9061},Board:{impressionType:"boardImpressions",idType:"boardIdStr",eventType:3700},Comment:{impressionType:"commentImpressions",idType:"commentIdStr",eventType:9127},Guide:{impressionType:"guideImpressions",idType:"term",eventType:7573},Interest:{impressionType:"topicImpressions",idType:"topicIdStr",eventType:3703},News:{impressionType:"newsHubData",idType:"newsIdStr",eventType:4110},OneBar:{impressionType:"oneBarImpressions",idType:"onebarIdStr",eventType:9993},Pin:{impressionType:"pinImpressions",idType:"pinIdStr",eventType:18},Search:{impressionType:"searchImpressions",idType:"term",eventType:3803},Story:{impressionType:"storyImpression",idType:"idStr",eventType:170},TodayArticle:{impressionType:"todayArticleImpressions",idType:"todayArticleIdStr",eventType:8569},User:{impressionType:"userImpressions",idType:"userIdStr",eventType:3704},AdsPreview:{impressionType:"AdsPreviewImpression",idType:"AdsPreviewStr",eventType:8600},BoardMoreIdeasRep:{impressionType:"boardMoreIdeasFeedUpsellImpressions",idType:"boardIdStr",eventType:10054},Notification:{impressionType:"notificationDetailImpressions",idType:"newsIdStr",eventType:4111},NotificationFeed:{impressionType:"notificationFeedImpressions",idType:"newsIdStr",eventType:4110},EditorialBoard:{impressionType:"editorialBoardImpressions",idType:"boardIdStr",eventType:3700},VaseAnnotation:{impressionType:"vaseAnnotationImpressions",idType:"vaseAnnotationUrlStr",eventType:16444}},I=({events:e,startTime:t,endTime:i})=>e?.filter(e=>e>=t&&e<=i)||[];function P({carouselData:e,closeupImpressionType:t,closeupNavigationType:i,componentType:a,contextLogData:s,clientTrackingParams:P,duploShouldTrackPinEvents:f,elementType:x,impressionAuxFields:h,inImpressionExp:E,impressionType:S,impressionsFramework:D,isPaused:b,loggingId:_,objectIdStr:R,slotIndex:A,trackCarousel:k,viewData:F,viewParameter:N,viewType:C,isPromoted:O,storyPinProductEventData:L}){let{logContextEvent:Z}=(0,d.u)(),{logMrcVideoAdEventOnPlay:M}=(0,v.H)(),{userAgent:{browserName:H}}=(0,u.B)(),{checkExperiment:j}=(0,c.FJ)(),B=j("web_metrics_vapp_active_exp_v2").anyEnabled,{logStat:U}=(0,g.Yg)(),V=D||m.Z,W=(0,n.useRef)(null),J=(0,n.useRef)(e=>{});J.current=n=>{let r=y[S],d=r.idType,l={clientTrackingParams:P,endTime:n.endTime,[d]:_,slotIndex:A,time:n.startTime,renderDuration:n.endTime-n.startTime,type:t,...h,forcedExit:"removed"===n.forcedExit?0:void 0};if("Pin"===S){let e=[],t=n.visibleEvents||new Map,i=n.hiddenEvents||new Map,a=[1,50,80,2,102];if(B){if(h&&h.isPromoted||O){let t=n.visibleEventsV2||new Map,i=n.hiddenEventsV2||new Map;a.forEach(a=>{let s=I({events:t.get(a),startTime:n.startTime,endTime:n.endTime}),r=I({events:i.get(a),startTime:n.startTime,endTime:n.endTime});s.forEach(t=>{e.push({type:a,time:t||0,visible:!0})}),r.forEach(t=>{e.push({type:a,time:t||0,visible:!1})})})}}else a.forEach(n=>{t.has(n)&&e.push({type:n,time:1e6*(t.get(n)||0),visible:!0}),i.has(n)&&e.push({type:n,time:1e6*(i.get(n)||0),visible:!1})});if(l={...l,pinCellWidth:n.pinCellWidth||0,pinCellHeight:n.pinCellHeight||0,windowWidth:window?.innerWidth,windowHeight:window?.innerHeight,visibleEvents:e.sort((e,t)=>e.time-t.time)},(0,p.i7)(H)&&h&&h.isPromoted){let{attributionSourceId:e,isPromoted:t,link:i,campaignId:n,araAuxData:a,advertiserId:s,domain:r,adDestinationUrl:p}=h;o(S,t??null,e??null,i??null,n??null,a??null,s??null,r??null,p??null)}}let m={component:a,object_id_str:R,view_type:C,view_data:F||{},view_parameter:N};if(k)e&&k&&Z({event_type:7352,event_data:{pinCarouselSlotImpressions:[{...l,..."canonical"===e.type?{carouselDataId:Number(e.carouselId??0),slotIndex:e.index,carouselSlotId:e.carouselSlots?.[e.index??0]&&Number(e.carouselSlots[e.index??0].slotId)}:{carouselDataId:Number(e.id??0),carouselSlotId:e.carousel_slots?.[e.index??0]&&Number(e.carousel_slots[e.index??0].id),slotIndex:e.index}}]},...m,aux_data:{...s}});else{let e={clientTrackingParams:P,event_type:r.eventType,...m,element:x,event_data:{[r.impressionType]:"Story"===S?l:[l],...L?{storyPinProductEventData:L}:{}},aux_data:{closeup_navigation_type:i,...s}};Z(e),M(e)}f&&U("log_pin_impression")};let{expName:Y,group:G}=(0,l.Z)({skipActivation:!0}),X=(0,T.ZP)(),q=(0,w.Zv)(),{isAuthenticated:$}=(0,u.B)(),z=(0,n.useCallback)(()=>{let e=!1;try{let{current:t}=W;if(t instanceof HTMLElement&&(!O||t.getElementsByTagName("img").length>0)){let i=V.start(t);i.onExitViewport(J.current).setDebugId(_||"unknown"),f&&i.onEnterViewport(()=>{U("log_pin_impression_track_enter_viewport")}),e=!0,G&&(0,r.nP)("webapp.masonry.trackImpression",{tags:{callsite:"app_packages_useImpressionTracker",deviceType:X,experimentName:Y,group:G,handlerId:q,isAuthenticated:$,slotIndex:A??"unknown"}})}}catch{window.console.error('Can only track impressions for type "HTMLElement"')}f&&U("log_pin_impression_track",{didStartTracking:e})},[W.current]);return(0,n.useEffect)(()=>(E&&!V.inExperiment&&V.setExperimentStatus(!0),B&&!V.inVAppActiveExp&&V.setInVAppActiveExp(!0),b||z(),()=>{let{current:e}=W;e instanceof HTMLElement&&(!O||e.getElementsByTagName("img").length>0)&&V.stop(e)}),[b,z]),W}let f=({children:e,...t})=>e({impressionTrackerRef:P(t)})},422908:(e,t,i)=>{i.d(t,{H:()=>d,W:()=>l});var n=i(667294),a=i(19963),s=i(218291),r=i(967312),o=i(785893);let{Provider:p,get:d}=(0,s.Z)("VideoPlayer");function l({children:e}){let{logContextEvent:t,logImpression:i}=(0,a.u)(),{checkExperiment:s}=(0,r.FJ)(),[d,l]=(0,n.useState)(!1),[m,c]=(0,n.useState)([]),[u,T]=(0,n.useState)([]),[v,g]=(0,n.useState)({}),w=s("web_ads_mrc_video_impression").anyEnabled,y=e=>{g(t=>({...t,[e]:!0}))},I=(0,n.useCallback)(e=>{if(18===e.event_type&&e.event_data?.pinImpressions?.length){let{isNativeVideoAndWatchable:t}=e.event_data.pinImpressions[0],i=JSON.stringify(e.aux_data?.commerce_data||"").includes("story_pin_id");w&&(t||i)&&c(t=>[...t,e].slice(-1e3))}},[w]),P=(0,n.useCallback)(e=>{18===e.eventType&&w&&T(t=>[...t,e].slice(-1e3))},[w]);(0,n.useEffect)(()=>{let e=m.filter(e=>{let{pinIdStr:i}=e.event_data.pinImpressions[0];return!v[i]||!w||(t((e=>{let{time:t}=e.event_data.pinImpressions[0];return{...e,event_data:{...e.event_data,pinImpressions:[{...e.event_data.pinImpressions[0],isMrcBtr:!0,endTime:t,renderDuration:0}]}}})(e)),!1)});e.length!==m.length&&c(e)},[m,w,t,v]),(0,n.useEffect)(()=>{let e=u.filter(e=>{let t=e.eventData?.pinIdStr;if(!t)return!1;if(v[t]&&w){let t=(e=>{if(e.eventData){let{time:t}=e.eventData;return{...e,eventData:{...e.eventData,isMrcBtr:!0,endTime:t??0}}}return null})(e);return t&&i(t),!1}return!0});e.length!==u.length&&T(e)},[u,w,i,v]);let f=(0,n.useMemo)(()=>({captionsEnabled:d,logMrcVideoAdImpressionOnPlay:P,logMrcVideoAdEventOnPlay:I,setCaptionsEnabled:l,setVideoPlayed:y,videosPlayed:v}),[d,I,P,v]);return(0,o.jsx)(p,{value:f,children:e})}},765575:(e,t,i)=>{i.d(t,{Cy:()=>d,HE:()=>l,JE:()=>u,Mv:()=>s,Y4:()=>m,dL:()=>a,fS:()=>c,fv:()=>o,qS:()=>p,u:()=>T,uc:()=>r});var n=i(586033);let a=e=>{let t=(0,n.ZP)({impressionAuxFields:{...e.impressionData||{}},clientTrackingParams:e.trackingParams,duploShouldTrackPinEvents:e.duploShouldTrackPinEvents,loggingId:e.loggingId,slotIndex:e.slotIndex,contextLogData:e.auxData||{},componentType:e.component,impressionType:"Pin",isPaused:e.isPaused,objectIdStr:e.objectIdStr,viewData:e.viewData,viewType:e.viewType||1,viewParameter:e.viewParameter});return e.children({impressionTrackerRef:t})},s=e=>{let t=(0,n.ZP)({impressionAuxFields:{newsType:e.newsType,displayMode:e.displayMode,newsIndex:e.newsIndex||0,tapItemIdStr:e.tapItemIdStr},contextLogData:e.auxData||{},impressionType:"Notification",loggingId:e.notificationId,viewType:107,viewParameter:3082});return e.children({impressionTrackerRef:t})},r=e=>{let t=(0,n.ZP)({impressionAuxFields:{newsType:e.newsType},contextLogData:e.auxData||{},impressionType:"NotificationFeed",loggingId:e.notificationId,viewType:107,viewParameter:3082});return e.children({impressionTrackerRef:t})},o=e=>{let t=(0,n.ZP)({impressionAuxFields:{...e.impressionData||{}},contextLogData:e.auxData||{},componentType:e.component,isPaused:e.isPaused,loggingId:e.loggingId,objectIdStr:e.objectIdStr,viewData:e.viewData,viewType:e.viewType||1,viewParameter:e.viewParameter,clientTrackingParams:e.trackingParams,slotIndex:e.slotIndex,impressionType:"Article"});return e.children({impressionTrackerRef:t})},p=e=>{let t=(0,n.ZP)({impressionAuxFields:{...e.impressionData||{}},clientTrackingParams:e.trackingParams,slotIndex:e.slotIndex,contextLogData:e.auxData||{},componentType:e.component,impressionType:"Story",isPaused:e.isPaused,loggingId:e.loggingId,objectIdStr:e.objectIdStr,viewData:e.viewData,viewType:e.viewType||1,viewParameter:e.viewParameter});return e.children({impressionTrackerRef:t})},d=e=>{let t=(0,n.ZP)({impressionAuxFields:{...e.impressionData||{}},clientTrackingParams:e.trackingParams,slotIndex:e.slotIndex||0,contextLogData:e.auxData||{},componentType:e.component,impressionType:"User",isPaused:e.isPaused,loggingId:e.loggingId,objectIdStr:e.objectIdStr,viewData:e.viewData,viewType:e.viewType||1,viewParameter:e.viewParameter});return e.children({impressionTrackerRef:t})},l=e=>{let t=(0,n.ZP)({impressionAuxFields:{...e.impressionData||{}},clientTrackingParams:e.trackingParams,slotIndex:e.slotIndex||0,contextLogData:e.auxData||{},componentType:e.component,impressionType:"Interest",isPaused:e.isPaused,loggingId:e.loggingId,objectIdStr:e.objectIdStr,viewData:e.viewData,viewType:e.viewType,viewParameter:e.viewParameter});return e.children({impressionTrackerRef:t})},m=e=>{let t=(0,n.ZP)({impressionAuxFields:{...e.impressionData||{}},clientTrackingParams:e.trackingParams,slotIndex:e.slotIndex,contextLogData:e.auxData||{},componentType:e.component,impressionType:"TodayArticle",isPaused:e.isPaused,loggingId:e.loggingId,objectIdStr:e.objectIdStr,viewData:e.viewData,viewType:e.viewType||1,viewParameter:e.viewParameter});return e.children({impressionTrackerRef:t})},c=e=>{let t=(0,n.ZP)({impressionAuxFields:{...e.impressionData||{}},clientTrackingParams:e.trackingParams,slotIndex:e.slotIndex,contextLogData:e.auxData||{},componentType:e.component,impressionType:"Board",loggingId:e.loggingId,viewType:e.viewType||1,viewParameter:e.viewParameter,viewData:e.viewData});return e.children({impressionTrackerRef:t})},u=e=>{let t=(0,n.ZP)({carouselData:e.carouselData,impressionType:"Pin",loggingId:e.loggingId,slotIndex:e.slotIndex??0,trackCarousel:!0,viewParameter:e.viewParameter||72,viewType:e.viewType||1,isPaused:e.isPaused,contextLogData:e.contextLogData,componentType:e.component,impressionAuxFields:e.impressionAuxFields});return e.children({impressionTrackerRef:t})},T=e=>{let t=(0,n.ZP)({impressionAuxFields:{...e.impressionData||{}},clientTrackingParams:e.trackingParams,slotIndex:e.slotIndex,contextLogData:e.auxData||{},componentType:e.component,impressionType:"EditorialBoard",isPaused:e.isPaused,loggingId:e.loggingId,objectIdStr:e.objectIdStr,viewData:e.viewData,viewType:e.viewType||1,viewParameter:e.viewParameter});return e.children({impressionTrackerRef:t})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/65575-811d3a0fd64a59ca.mjs.map